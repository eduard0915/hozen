{% extends 'body.html' %}
{% load static %}
{% load widget_tweaks %}

{% block head %}
    <script src="{% static 'lib/material-dashboard-pro-html-v1.1.0/assets/js/jquery-3.1.1.min.js' %}"></script>
    <script src="{% static 'lib/material-dashboard-pro-html-v1.1.0/assets/js/material.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'lib/material-dashboard-pro-html-v1.1.0/assets/js/moment.min.js' %}"></script>
    <script src="{% static 'lib/moment-es/es.js' %}"></script>
    <script src="{% static 'lib/material-dashboard-pro-html-v1.1.0/assets/js/bootstrap-datetimepicker.js' %}"></script>
    <style>
        .datetimepicker {
            z-index: 1600 !important; /* has to be larger than 1050 */
        }
    </style>
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-md-9">
            <div class="card">
                <div class="card-header card-header-icon" data-background-color="rose">
                    <i class="material-icons">assignment_ind</i>
                </div>
                <div class="card-content">
                    <h4 class="card-title">{{ entity }} - {{ object.username }}</h4>
                    <div class="card-content">
                        <div class="row">
                            <div class="col-md-3">
                                <p class="description">N° Identificación:</p>{{ object.cedula }}
                            </div>
                            <div class="col-md-3">
                                <p class="description">N° Celular:</p>{{ object.cellphone }}
                            </div>
                            <div class="col-md-3">
                                <p class="description">E-mail:</p>{{ object.email }}
                            </div>
                            <div class="col-md-3">
                                <p class="description">E-mail Personal:</p>
                                {% if object.email_person == None %}
                                    Sin Registro
                                {% else %}
                                    {{ object.email_person }}
                                {% endif %}
                            </div>
                        </div>
                        <br>
                        <div class="row">
                            <div class="col-md-3">
                                <p class="description">Fecha de Nacimiento:</p>
                                {% if object.date_birth == None %}
                                    Sin Registro
                                {% else %}
                                    {{ object.date_birth }}
                                {% endif %}
                            </div>
                            <div class="col-md-3">
                                <p class="description">Dirección:</p>
                                {% if object.address_user %}
                                    {{ object.address_user }}
                                {% else %}
                                    Sin Registro
                                {% endif %}
                            </div>
                            <div class="col-md-3">
                                <p class="description">Fecha de Creación:</p>{{ object.date_joined | date:'Y-m-d' }}
                            </div>
                            <div class="col-md-3">
                                <p class="description">Ultima Sesión:</p>
                                {% if object.last_login %}
                                    {{ object.last_login | date:'Y-m-d H:m' }}
                                {% else %}
                                    Sin Registro de Ingreso
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card card-profile">
                <div class="card-content">
                    <h6 class="category text-gray">{{ object.cargo }}</h6>
                    <h4 class="card-title">{{ object.get_full_name }}</h4>
                    <h4 class="card-title text-success" style="font-weight: bold">{% if object.is_active == True %}
                        Activo {% endif %}</h4>
                    <h4 class="card-title text-danger" style="font-weight: bold">{% if object.is_active == False %}
                        Inactivo {% endif %}</h4>
                    <div class="row">
                        <a href="{% url 'user:user_profile_update' request.user.id %}" class="btn btn-primary btn-round">Editar</a>
                        <a onclick="open_modal_two('/user/edit/password/')" class="btn btn-rose btn-round">Actualizar Contraseña</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-9">
            <div class="card" style="margin-top: 0">
                <div class="card-content">
                    <h4 class="card-title">Formación Académica</h4>
                    <div class="material-datatables">
                        <table id="datatable"
                               class="table table-striped table-no-bordered table-hover"
                               style="width:100%">
                            <thead style="font-size: 9pt">
                            <tr>
                                <th class="text-center" style="width:35%">Título</th>
                                <th class="text-center" style="width:35%">Institución Académica</th>
                                <th class="text-center" style="width:15%">Fecha</th>
                                <th class="text-center" style="width:15%">Diploma</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for fo in academic %}
                                <tr>
                                    <td>{{ fo.academic_title }}</td>
                                    <td>{{ fo.academic_institution }}</td>
                                    <td>{{ fo.date_graduation | date:'Y-m-d' }}</td>
                                    <td>
                                        {% if fo.file_diploma %}
                                            <a title="Descargar Certificado" target="_blank"
                                               class="btn btn-simple btn-rose btn-icon"
                                               href="/calibration/certificate?id={{ fo.id }}&type=file_diploma">
                                                <i class="material-icons">file_present</i></a>
                                        {% else %}
                                            <i class="material-icons">not_interested</i>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">

        $(function () {
            $('.btnTest').on('click', function () {
                $.ajax({
                    url: window.location.pathname,
                    type: 'POST',
                    data: {id: 1},
                    dataType: 'json'
                }).done(function (data) {
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus + ': ' + errorThrown);
                }).always(function (data) {
                });
            });

            $('#datatable').DataTable({
                responsive: false,
                autoWidth: false,
                order: [[4, 'desc']],
                destroy: true,
                deferRender: true,
                language: {
                    url: "//cdn.datatables.net/plug-ins/1.10.21/i18n/Spanish.json"
                },
                columnDefs: [
                    {
                        targets: [0, 1, 2, 3, 4],
                        class: 'td-actions text-center'
                    },
                ],
            });
        });

    </script>
    <script type="text/javascript">
        $('#date_graduation').datetimepicker({
            format: 'YYYY-MM-DD',
            locale: 'es',
            defaultDate: $('.date_graduation'),
            icons: {
                time: "fa fa-clock-o",
                date: "fa fa-calendar",
                up: "fa fa-chevron-up",
                down: "fa fa-chevron-down",
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-remove',
            },
        });
    </script>
{% endblock %}