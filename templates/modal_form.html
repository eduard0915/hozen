{% load static %}

{#    <style>#}
{#        .datetimepicker {#}
{#            z-index: 1600 !important; /* has to be larger than 1050 */#}
{#        }#}
{#    </style>#}

<div class="modal-dialog modal-notice">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i
                    class="material-icons">clear</i>
            </button>
            <h5 class="modal-title" id="myModalLabel">{{ entity }}</h5>
        </div>
        <div class="modal-body">
            <form enctype="multipart/form-data" method="post" action="{{ act }}">
                {% csrf_token %}
                <input type="hidden" value="{{ action }}" name="action">
                <div class="modal-body">
                                         {% for field in form.visible_fields %}
                            {% if forloop.first %}
                                <div class="row">
                            {% endif %}
                        <div class="col-md-6">
                            <div {% if field.name == 'is_active' %} class="checkbox"
                            {% elif field.name == 'file_diploma' %}
                                                                    class="fileinput fileinput-new text-center"
                                                                    data-provides='fileinput'
                            {% else %} class="form-group label-floating" {% endif %}>
                                {% if field.name == 'is_active' %}
                                    <label>
                                        {{ field }}
                                        {{ field.label }}
                                    </label>
                                {% elif field.name == 'file_diploma' %}
                                    <div class="fileinput-preview fileinput-exists thumbnail"></div>
                                    <div>
                                    <span class="btn btn-rose btn-round btn-file">
                                        <span class="fileinput-new">{{ field.label }}</span>
                                        <span class="fileinput-exists">Cambiar</span>
                                        {{ field }}
                                    </span>
                                        <a href="#" class="btn btn-danger btn-round fileinput-exists"
                                           data-dismiss="fileinput"><i class="fa fa-times"></i> Eliminar</a>
                                    </div>
                                {% else %}
                                    <label class="control-label" for=id_{{ field.name }}">
                                        {{ field.label }}
                                    </label>
                                    {{ field }}
                                {% endif %}
                                {% if field.help_text %}
                                    <span class="help-block">{{ field.help_text }}</span>
                                {% endif %}
                            </div>
                        </div>
                        {% if forloop.last %}
                            </div>
                        {% elif forloop.counter|divisibleby:2 %}
                            </div>
                            <div class="row">
                        {% endif %}
                        {% endfor %}
                </div>
                <div class="modal-footer text-center">
                    <button type="button" class="btn btn-danger btn-round" data-dismiss="modal">Cerrar</button>
                    <button type="submit" class="btn btn-success btn-round">Guardar</button>
                </div>
            </form>
        </div>
    </div>
 <script>

        $('form').on('submit', function (e) {
            e.preventDefault();
            let parameters = new FormData(this);
            const form_action = $(this).attr('action');
            $.ajax({
                url: form_action,
                type: 'POST',
                data: parameters,
                dataType: 'json',
                processData: false,
                contentType: false,
            }).done(function (data) {
                console.log(data);
                if (!data.hasOwnProperty('error')) {
                    location.href = window.location.pathname;
                    return false;
                 }
                console.log(data.error);
            }).fail(function (jqXHR, textStatus, errorThrown) {
                alert(textStatus + ': ' + errorThrown);
            }).always(function (data) {
            });
        });

        $('#date_graduation').datetimepicker({
            format: 'YYYY-MM-DD',
            locale: 'es',
            defaultDate: $('.date_graduation'),
            icons: {
                time: "fa fa-clock-o",
                date: "fa fa-calendar",
                up: "fa fa-chevron-up",
                down: "fa fa-chevron-down",
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-remove',
            },
        });



    </script>
</div>

